"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[308],{2308:(e,s,t)=>{t.r(s),t.d(s,{default:()=>l});var r=t(5043),i=t(3216),n=t(579);const c=(0,r.lazy)((()=>t.e(220).then(t.bind(t,4220)))),l=()=>{const[e,s]=(0,r.useState)([]),[t,l]=(0,r.useState)(null),[o,a]=(0,r.useState)(!0),[d,h]=(0,r.useState)(!1),[j,x]=(0,r.useState)(null),[u,m]=(0,r.useState)(1),p=(0,i.Zp)(),v=e=>{(async e=>{const s=localStorage.getItem("authToken");try{const t=await fetch(`https://prasad-gz5p.onrender.com/api/view-invoice/${e}/`,{headers:{Authorization:`Token ${s}`}});if(!t.ok)throw new Error("Failed to get Invoice");const r=await t.json();x(r),h(!0),l(null)}catch(t){l(t.message)}})(e)},b=()=>{h(!1),x(null)},y=7*u,k=y-7,g=e.slice(k,y),N=Math.ceil(e.length/7);return(0,r.useEffect)((()=>{(async()=>{const e=localStorage.getItem("authToken");try{const t=await fetch("https://prasad-gz5p.onrender.com/api/order-history/",{headers:{Authorization:`Token ${e}`}});if(!t.ok)throw new Error("Failed to fetch order history");const r=await t.json();s(r.orders?r.orders.reverse():[]),l(null)}catch(t){l(t.message)}finally{a(!1)}})()}),[]),(0,n.jsxs)("div",{className:"order-historyV890",children:[(0,n.jsxs)("div",{className:"order-history-containerV890",children:[(0,n.jsx)("p",{className:"order-history-title-V890",children:"Your Order History"}),(0,n.jsx)("button",{onClick:()=>p("/customer-home"),className:"back-button999V890",children:"Back to Home"})]}),(0,n.jsx)("div",{className:"order-history1V890",children:o?(0,n.jsx)("div",{className:"order-spinner",children:(0,n.jsx)(c,{})}):(0,n.jsxs)(n.Fragment,{children:[t&&(0,n.jsx)("p",{className:"error-message",children:t}),e.length>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("table",{className:"order-tableV890",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Order ID"}),(0,n.jsx)("th",{children:"Price of Products"}),(0,n.jsx)("th",{children:"Action"})]})}),(0,n.jsx)("tbody",{children:g.map(((e,s)=>(0,n.jsxs)("tr",{className:"order-itemV890",children:[(0,n.jsx)("td",{children:e.id}),(0,n.jsxs)("td",{children:["\u20b9",e.price]}),(0,n.jsx)("td",{children:(0,n.jsx)("button",{className:"view-invoice-buttonV890",onClick:()=>v(e.id),children:"View Invoice"})})]},s)))})]}),(0,n.jsxs)("div",{className:"pagination-controls",children:[(0,n.jsx)("button",{onClick:()=>{u>1&&m((e=>e-1))},disabled:1===u,children:"Previous"}),(0,n.jsxs)("span",{children:["Page ",u," of ",N]}),(0,n.jsx)("button",{onClick:()=>{u<N&&m((e=>e+1))},disabled:u===N,children:"Next"})]})]}):(0,n.jsx)("p",{children:"Your order history is empty"})]})}),d&&(0,n.jsx)("div",{className:"modal-overlayV890",onClick:b,children:(0,n.jsxs)("div",{className:"modal-contentV890",onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("h2",{children:"Invoice Details"}),j&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h3",{children:["Invoice ID: ",j.invoice_id]}),(0,n.jsxs)("table",{className:"invoice-tableV890",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Product ID"}),(0,n.jsx)("th",{children:"Quantity"}),(0,n.jsx)("th",{children:"Total Price"})]})}),(0,n.jsx)("tbody",{children:j.items.slice().reverse().map(((e,s)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:e.product_id}),(0,n.jsx)("td",{children:e.quantity}),(0,n.jsxs)("td",{children:["\u20b9",e.total_price]})]},s)))})]})]}),(0,n.jsx)("button",{className:"close-buttonV890",onClick:b,children:"Close"})]})})]})}}}]);
//# sourceMappingURL=308.fcb88a8a.chunk.js.map